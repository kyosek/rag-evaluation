from LLMServer.llama.llama_instant import ModelFactory, ModelType


    
def main():
    prompt = """
    <SYS>
    You are an expert exam question verifier.
    Analyse if this question requires synthesising information across multiple document chunks to be correctly answered.
    
    Task:
    1. Evaluate if the question can be answered using a single chunk or requires multiple chunks
    2. Identify which specific chunks contain relevant information
    3. Verify if the answer requires combining information across chunks
    4. Check if any crucial information is missing from the provided chunks

    Output format:
    {
    "single_chunk_answerable": boolean,  # Can the question be answered using only one chunk?
    "required_chunks": [                 # List of chunk numbers needed to answer
    int,                            # e.g., [1, 3] means chunks 1 and 3 are needed
    ],
    "synthesis_required": boolean,       # Does answering require combining info across chunks?
    "reasoning": string,                # Explanation of how the information needs to be combined
    "missing_information": string,      # Optional: Note any missing crucial information
    "confidence": int                   # 1-5 scale of confidence in this assessment
    }
    </SYS>
    
    "question": "Under what circumstances might OSMRE be required to adjust the financial assurances provided by a coal mine operator, even after the mine has received its initial permit?",
    "choices": [
      "A) If the operator experiences financial difficulties and is unable to meet their existing financial obligations.",
      "B) If the state regulatory authority determines that the mine is not effectively reclaiming the land according to SMCRA standards.",
      "C) If unforeseen long-term water pollution issues arise, requiring additional treatment beyond the initial reclamation plan.",
      "D) If the operator requests a variance from the regulatory authority to deviate from the original mine site contour."
    ],
    "correct_answer": "C",
    "documentation": [
      "SMCRA allows an individual state or Indian tribe to develop its own program to implement the act if the Secretary of the Interior finds that the program is in accordance with federal law. A state with an approved program is said to have “primacy” for that program. To obtain primacy, a state or Indian tribe submits to the Secretary of the Interior for approval a program that demonstrates that the state or tribe has the capability of carrying out the requirements of SMCRA. The program must demonstrate that the state or Indian tribe has, among other things, a law that provides for the regulation of the surface effects of coal mining and reclamation in accordance with the requirements of SMCRA, and a regulatory authority with sufficient personnel and funding to do so. Of the 25 states and four Indian tribes that OSMRE identified as having active coal mining in 2017, 23 states had primacy, and OSMRE manages the coal program in 2 states and for the four Indian tribes. SMCRA requires a mine operator to obtain a permit before starting to mine. The permit process requires operators to submit plans describing the extent of proposed mining operations and how and on what timeline the mine sites will be reclaimed. In general, an operator must reclaim the land to a use it was capable of supporting before mining or to an alternative postmining land use that OSMRE or the state regulatory authority deems higher or better than the premining land use. In reclaiming the mine site, operators must comply with regulatory standards that govern, among other things, how the reclaimed area is regraded, replanting of the site, and the quality of water flowing from the site. Specifically: Operators are generally required to return mine sites to their approximate original contour unless the operator receives a variance from the regulatory authority. To return to this contour, the surface configuration achieved by backfilling and grading of the mined area must closely resemble the general surface configuration of the land before mining and blend into and complement the drainage pattern of the surrounding terrain, with all highwalls and spoil piles eliminated.",
      "Under SMCRA, OSMRE is required to evaluate each primacy state’s coal program annually to ensure that it complies with SMCRA. SMCRA includes a requirement that the regulatory authority secure necessary financial assurances to assure the reclamation of each permitted mine site. While OSMRE’s directive on oversight of state and tribal regulatory programs does not instruct the agency to review state regulatory authority calculations of financial assurance amounts, it instructs OSMRE to focus on the state programs’ success in achieving the overall purposes of SMCRA. For example, OSMRE, in conducting its oversight, is to evaluate the states’ effectiveness in successfully reclaiming lands affected by mining and in avoiding negative effects outside of areas authorized for mining activities. If OSMRE’s review of a state program identifies an issue that could result in the state not effectively implementing, administering, enforcing, or maintaining all or any portion of its approved coal program, OSMRE can work with the state regulatory authority to develop an action plan to correct the issue. If a state regulatory authority does not take the necessary corrective action, OSMRE may begin the process of withdrawing approval for a part or all of the state’s primacy. In addition to annually evaluating state programs, OSMRE can conduct national or regional reviews on specific topics. For example, OSMRE conducted a national review in 2010 that examined how state regulatory authorities calculated the required amount of financial assurances for coal mine reclamation. The review examined financial assurance practices in 23 states and reported that on the basis of the sample of mining permits reviewed, OSMRE was unable to determine if the amount of financial assurances was adequate for at least one of the permits it reviewed in 10 of the 23 states. Among the potential issues OSMRE identified were errors in the methods state regulatory authorities used to calculate financial assurance amounts and insufficient information in the reclamation plan upon which to calculate reclamation costs.",
      "Operators are required to demonstrate successful revegetation of the mine site for 5 years (in locations that receive more than 26 inches of rain annually) or 10 years (in drier areas). States have requirements for what vegetation may be planted depending on the approved postmining land use. For example, West Virginia’s regulations call for sites with a postmining land use of forest land to be planted with at least 500 woody plants per acre. The state specifies that at least five species of trees be used, including at least three of the species being higher value hardwoods, such as oak, ash, or maple. SMCRA requires that financial assurances be sufficient to ensure reclamation compliant with water quality standards, including those established by the Environmental Protection Agency or the states under the Clean Water Act. SMCRA’s implementing regulations also contain additional water protection requirements. For example, the regulations require that all surface mining and reclamation activities be conducted to minimize disturbance of the hydrologic balance within the permit and adjacent areas and to prevent material damage to the hydrologic balance outside the permit area. The federal government also enacted SMCRA, in part, to implement an abandoned mine land program to promote the reclamation of mined areas left without adequate reclamation prior to 1977, when SMCRA was enacted, and that continue to substantially degrade the quality of the environment, prevent or damage the beneficial use of land or water resources, or endanger the health or safety of the public. Specifically, Congress found that a substantial number of acres of land throughout the United States had been disturbed by surface and underground coal mining on which little or no reclamation was conducted. Further, it found that the impacts from these unreclaimed lands imposed social and economic costs on residents in nearby areas as well as impaired environmental quality. Since the abandoned mine land program was created, approximately $3.9 billion has been spent to reclaim abandoned mine lands, and there is at least $10.2 billion in remaining reclamation costs for coal mines abandoned prior to 1977, as of September 30, 2017, according to OSMRE.",
      "Similar issues involving bankruptcies of hardrock mining operators led the Bureau of Land Management to implement regulations in 2001 eliminating the use of self-bonding for hardrock mining. In doing so, the Bureau of Land Management determined that a self-bond is less secure than other types of financial assurances, especially in cases where commodity prices fluctuate. The agency also noted that operators that would otherwise be eligible to self-bond should not have a significant problem obtaining another type of financial assurance. In our previous work examining other types of environmental cleanup, we found that the financial risk to the government and the amount of oversight needed for self-bonds are relatively high compared to other forms of financial assurances. Furthermore, we also previously reviewed federal financial assurance requirements for coal mining, hardrock mining, onshore oil and gas extraction, and wind and solar energy production and found that of these activities coal mining is the only one where self-bonding was allowed. Because SMCRA explicitly allows states to decide whether to accept self-bonds, eliminating the risk that self-bonding poses to the federal government and states would require that SMCRA be amended. Unanticipated reclamation costs, such as those related to long-term treatment for water pollution, may arise late in a mine’s projected lifespan, and the operator may not have the financial means to cover the additional costs, according to OSMRE officials. Under SMCRA, OSMRE and state regulatory authorities are not to approve a permit for a coal mine if the regulatory authority expects the mine to result in long-term water pollution. As a result, since long-term water pollution is not anticipated to occur, the cost of addressing it would not be included in the initial financial assurance that the operator provides. If the regulatory authority later determines that long-term water treatment is needed, the regulatory authority must adjust the amount of financial assurance that the operator is required to provide."
    ],
    """
    llm = ModelFactory.create_model(ModelType.MINISTRAL_8B)
    response = llm.invoke(prompt)
    print(f"Response: {response}\n")


if __name__ == "__main__":
    main()
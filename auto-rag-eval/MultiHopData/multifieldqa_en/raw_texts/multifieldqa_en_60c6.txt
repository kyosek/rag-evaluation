Paper Info

Title: An CUSUM Test with Observation-Adjusted Control Limits in Change Detection
Publish Date: March 9, 2023
Author List: Fuquan Tang (from Department of Statistics, Shanghai Jiao Tong University), Dong Han (from Department of Statistics, Shanghai Jiao Tong University)

Figure

exp{−cg(µ)(θ − x Hv (θ) + o(1))} for 1 ≤ k ≤ ac − 1, bc ≤ n ≤ m, where Zi = −g ′ (µ)(Z i − µ)/a and Hv (θ) = ln hv (θ) + ( ac k − 1) ln ĥv (θ), ĥv (θ) = E v (e θ Zi ).
i < cg(µ)(1 + o(1))) exp{−cg(µ)θ * v (1 + o(1))} (A. 5) for ac ≤ k ≤ bc − 1, bc ≤ n ≤ m,andP v (
i + g ′ (µ)a −1 Tc(g)−1 i=Tc(g)−ac (Z i − µ)] −→ µas c → ∞.By the uniform integrability of {T c (g)/c} and using Theorem A.1.1 in Gut's book(1988), we haveE v (T c (g)) = (1 + o(1)) cg(µ) µfor a large c.This completes the proof of Theorem 2.Proof of Theorem 4. Since g(x) < 0 for x > a * , a * ≤ µ * and µ * ≥ 0, it follows thatP v m Ẑm < cg( Ẑm ), Ẑm > a * ≤ P v ( Ẑm < µ * )andP v (T c (g) > m) = P v n i=n−k+1 Z i < cg( Ẑn ), 1 ≤ k ≤ n, 1 ≤ n ≤ m ≤ P v m Ẑm < cg( Ẑm ) = P v m Ẑm < cg( Ẑm ), Ẑm ≤ a * + P v m Ẑm < cg( Ẑm ), Ẑm > a * ≤ 2P v ( Ẑm < µ * ).Furthermore,P v ( Ẑm < µ * ) = P v ( m i −Z i > −mµ * ) = P v ( m i (µ − Z i ) > m(µ − µ * )) = P v (e θ m i (µ−Z i ) > e θm(µ−µ * ) ) ≤ e −m[θ(µ−µ * )−ln M (θ)] ,whereM(θ) = E v (e θ(µ−Z 1 )) and the last inequality follows from Chebychev's inequality.Note thath(θ) = θ(µ − µ * ) − ln M(θ) attains its maximum value h(θ * ) = θ * (µ − µ * ) − ln M(θ * ) > 0 at θ = θ * > 0, where h ′ (θ * ) = 0. So, E v (T c (g)) = 1 + ∞ m=1 P v (T c (g) > m) ≤ 1 + m=1 −m[θ * (µ−µ * )−ln M (θ * )] = e θ * (µ−µ * )−ln M (θ * ) + 1 e θ * (µ−µ * )−ln M (θ * ) − Let k > 1.It follows that E vk (T c (g) − k + 1) + = ∞ m=1 P vk (T c (g) > m + k − 1, T c (g) > k − 1) ≤ (a 0 + 1)(k − 1)P 0 (T c (g) > k − 1) + ∞ m≥(a 0 +1)(k−1) P vk (T c (g) > m + k − 1).Similarly, we haveP vk (T c (g) > m + k − 1) = P vk n i=n−k+1 Z i < cg( Ẑn ), 1 ≤ k ≤ n, 1 ≤ n ≤ m + k − 1 ≤ 2P vk ( Ẑm+k−1 < µ * ) − Z i ) > m(µ − µ * ) + (k − 1)(µ 0 − µ * ) ≤ 2 exp{−m θ * (µ − µ * ) − ln M(θ * ) + k − 1 m [µ 0 − µ * − ln M 0 (θ * )] } ≤ e −mb for m ≥ (a 0 + 1)(k − 1), since θ * (µ − µ * ) − ln M(θ * ) + k − 1 m [µ 0 − µ * − ln M 0 (θ * )] ≥ b for m ≥ (a 0 + 1)(k−1).Thus, E vk (T c (g) − k + 1) + ≤ (a 0 + 1)(k − 1)P 0 (T c (g) ≥ k) + m≥(a 0 +1)(k−1) e −mb ≤ (a 0 + 1)(k − 1)P 0 (T c (g) >≥ k) + 2e −(a 0 +1)(k−1)b 1 − e −b .
Simulation of E τ i ,v and J ACE for detecting two mean shifts v = 0.1, v = 1.The parameters for T * M are k1=1, k2=150, r 1 = 5.2 * 10 −5 , r 2 = 1.1 * 10 −5 , and the expectation and standard deviation in both cases are 1717.06with 13459.80 and 3918.33 with 16893.25,respectively.

abstract

In this paper, we not only propose an new optimal sequential test of sum of logarithmic likelihood ratio (SLR) but also present the CUSUM sequential test (control chart, stopping time) with the observation-adjusted control limits (CUSUM-OAL) for monitoring quickly and adaptively the change in distribution of a sequential observations.
Two limiting relationships between the optimal test and a series of the CUSUM-OAL tests are established. Moreover, we give the estimation of the in-control and the out-of-control average run lengths (ARLs) of the CUSUM-OAL test. The theoretical results are illustrated by numerical simulations in detecting mean shifts of the observations sequence.

INTRODUCTION

In order to quickly detect a change in distribution of observations sequence without exceeding a certain false alarm rate, a great variety of sequential tests have been proposed, developed and applied to various fields since proposed a control chart method, see, for example, , , One of popular used sequential tests is the following upper-sided CUSUM test which was proposed by .
where c > 0 is a constant control limit, Z i = log[p v 1 (X i )/p v 0 (X i )], p v 0 (x) and p v 1 (x) are prechange and post-change probability density functions respectively for a sequence of mutually independent observations {X i , i ≥ 1}, that is, there is a unknown change-point τ ≥ 1 such that X 1 , ..., X τ −1 have the probability density function p v 0 , whereas, X τ , X τ +1 , ... have the probability density function p v 1 .
By the renewal property of the CUSUM test T C we have , where E 1 (T C ) is the out-of-control average run length (ARL 1 ), P k and E k denote the probability and expectation respectively when the change from p v 0 to p v 1 occurs at the change-point τ = k for k ≥ 1. Though we know that the CUSUM test is optimal under Lorden's measure (see Moustakides 1986 and Ritov 1990), the out-of-control ARL 1 of the CUSUM test is not small, especially in detecting small mean shifts ( see Table in Section 4).
In other words, the CUSUM test is insensitive in detecting small mean shifts. Then, how to increase the sensitivity of the CUSUM test ? Note that the control limit in the CUSUM test is a constant c which does not depend on the observation samples. Intuitively, if the control limit of the CUSUM test can become low as the samples mean of the observation sequence increases, then the alarm time of detecting the increasing mean shifts will be greatly shortened.
Based on this idea, by selecting a decreasing function g(x) we may define the ( upper-sided ) CUSUM chart T C (cg) with the observation-adjusted control limits cg( Ẑn ) ( abbreviated to the CUSUM-OAL chart ) in the following where c > 0 is a constant and Ẑn = n i=1 Z i /n. In other words, the control limits cg( Ẑn ) of the CUSUM-OAL test can be adjusted adaptively according to the observation information { Ẑn }.
Note that the control limits cg( Ẑn ) may be negative. In the special case, the CUSUM-OAL chart T C (cg) becomes into the conventional CUSUM chart T C (c) in (1) when g ≡ 1. Similarly, we can define a down-sided CUSUM-OAL test. In this paper, we consider only the upper-sided CUSUM-OAL test since the properties of the down-sided CUSUM-OAL test can be obtained by the similar method.
The main purpose of the present paper is to show the good detection performance of the CUSUM-OAL test and to give the estimation of its the in-control and out-of-control ARLs. The paper is organized as follows. In Section 2, we first present an optimal SLR sequential test, then define two sequences of the CUSUM-OAL tests and prove that one of the two sequences of CUSUM-OAL tests converges to the optimal test, another sequences of CUSUM-OAL tests converges to a combination of the optimal test and the CUSUM test.
The estimation of the in-control and out-of-control ARLs of the CUSUM-OAL tests and their comparison are given in Section 3. The detection performances of the three CUSUM-OAL tests and the conventional CUSUM test are illustrated in Section 4 by comparing their numerical out-ofcontrol ARLs. Section 5 provides some concluding remarks.
Proofs of the theorems are given in the Appendix.

AN OPTIMAL SLR TEST, TWO CUSUM-OAL TESTS AND THEIR LIMITING RELATIONSHIPS

Let P 0 and E 0 denote the probability and the expectation respectively with the probability density p v 0 when there is no change for all the time. It is known that It follows from Proposition 2.38 in and (5.8)-(5.9) in Chow et al, P.108) that the following sequence test of sum of logarithmic likelihood ratio (SLR)
for B > 1, is optimal in the following sense min for P 0 (T SLR < ∞) = α, where c = log B and 0 < α < 1. In particular, if P 0 is the standard normal distribution with mean shift µ > 0 after changepoint, we have Z j − µ 0 = µX j , where µ 0 = −µ 2 /2. It follows from proposition 4 in that the SLR test T SLR in (4) is also optimal (minimal ARL 1 ) with the same false alarm probability P 0 (T < τ ).
It can be seen that the in-control average run length of T SLR is infinite, that is, ARL 0 = E 0 (T SLR ) = ∞. However, the minimal ARL 1 with finite ARL 0 is a widely used optimality criterion in statistical quality control (see ) and detection of abrupt changes (see . In order to get finite ARL 0 for T SLR , we replace the constant control limit c of T SLR in (3) or (4) with the dynamic control limit n(µ 0 − r) and obtain a modified SLR test T SLR (r) in the following
for r ≥ 0. For comparison, the in-control ARL 0 of all candidate sequential tests are constrained to be equal to the same desired level of type I error, the test with the lowest out-of-control ARL v has the highest power or the fastest monitoring (detection) speed. In the following example 1, the numerical simulations of the out-of-control ARLs of the CUSUM-OAL tests T C (cg u,0 ) in detecting the mean shifts of observations with normal distribution will be compared with that of the SLR tests T * (r) and T * (0), and that of the CUSUM-SLR test T C (c) ∧ T * (0) := min{T C (c), T * (0)} in the following Table .
These comparisons lead us to guess that there are some limiting relationships between T C (cg u,r ) and T * (r), and T C (c g u ) and T C (c) ∧ T * (0), respectively. Example 1. Let X 1 , X 2 , .... be mutually independent following the normal distribution N(0, 1) if there is no change. After the change-point τ = 1, the mean E µ (X k ) ( k ≥ 1 ) will change from v 0 = 0 to v = 0.1, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 3. Here, we let
, where v 1 = 1 is a given reference value which for the CUSUM test is the magnitude of a shift in the process mean to be detected quickly. We conducted the numerical simulation based on 1,000,000 repetitions. The following Table lists the simulation results of the ARLs of the tests T C (c), T C (c g u ) for u = 1, 10, 10 2 , 10 3 , 10 4 , T * (0.0007), T C (c) ∧ T * (0) and T * (0) for detecting the mean shifts, where the mean shift 0.0 means that there is no change which corresponds to the in-control ARL 0 and all tests have the common ARL 0 ≈ 1000 except the test T * (0) which has ARL 0 = ∞.
The values in the parameters are the standard deviations of the tests. From the last row in Table , it's a little surprising that though the ARL 0 of T * (0) is infinite, that is, E 0 (T * (0)) = ∞, the detection speed of T * (0) is faster than that of the CUSUM chart T C for all mean shifts, in particular, for detecting the small mean shift 0.1, the speed of T * (0) is only 7.47 which is very faster than the speed, 439, of the CUSUM test.
Moreover, both control charts T * (0.0007) and T C (11.9271) ∧ T * (0) not only have the nearly same detection performance as T * (0) but also can have the finite in-control ARL 0 . Note particularly that when the number u in g u is taken from 0 to 1, 10, 10 2 , 10 3 , 10 4 , the detection speed of T C (c g u ) is getting faster and faster, approaching to that of T C (c) ∧ T * (0).
This inspires us to prove the following theoretic results. Let τ = 1 and {X k , k ≥ 1} be an i.i.d. observations sequence with Theorem 2 shows that when the constant control limit c of the CUSUM test T C (c) is replaced with the observation-adjusted control limits {cg u,r ( Ẑn )} and {c g u ( Ẑn )} respectively, the corresponding two CUSUM-OAL tests {T C (cg u,r )} and {T C (c g u )} will converge to the optimal SLR test T * (r) and the CUSUM-SLR test T C (c) ∧ T * (0) as u → ∞, respectively.
In other words, the fastest alarm times that {T C (cg u,r )} and {T C (c g u )} can be reached are T * (r) and T C (c) ∧ T * (0), respectively. u ≥ 0} can be seen as two "long bridges" connecting T C (c) and T * (r), and T C (c) and T C (c) ∧ T * (0), respectively.

ESTIMATION AND COMPARISON OF ARL OF THE CUSUM-OAL TEST

In this section we will give an estimation of the ARLs of the following CUSUM-OAL test that can be written as where g(.) is a decreasing function, Ẑn (ac x] denotes the smallest integer greater than or equal to x. Here Ẑn (ac) is a sliding average of the statistics, Next we discuss on the the post-change probability distribution in order to estimate the ARLs of T C (cg).
Usually we rarely know the post-change probability distribution P v of the observation process before it is detected. But the possible change domain and its boundary (including the size and form of the boundary) about v may be determined by engineering knowledge, practical experience or statistical data.
So we may assume that the region of parameter space V and a probability distribution Q on V are known. If we have no prior knowledge of the possible value of v after the change time τ , we may assume that v occurs equally on V , that is, the probability distribution Q is an equal probability distribution (or uniform distribution ) on V .
For example, let P v be the normal distribution and v = (µ, σ), where µ and σ denote the mean and standard deviation respectively, we can take the set V = {(µ, σ) : and Q is subject to the uniform distribution U(V ) on V if v occurs equally on V , where the numbers µ 1 , µ 2 , σ 1 and σ 2 are known. It means that we know the domain of the possible post-change distributions, P v , v ∈ V , i.e., the boundary ∂V of the parameter space V is known.
Next we shall divide the parameter space V into three subsets V + , V 0 and V − by the Kullback-Leibler information distance. Let and are two Kullblak-Leibler information distances between P v , P v 0 and P v , P v 1 . Since I(p|q) = 0 if and only if p = q, where p and q are two probability measures, it follows that
, it means that P v is closer to P v 0 than to P v 1 according to the Kullblak-Leibler information distance. There is a similar explanation for v ∈ V + or ∈ V 0 . Suppose the post-change distribution P v and the function g(x) satisfy the following conditions: (I) The probability P v is not a point mass at E v (Z 1 ) and P v (Z 1 > 0) > 0.
(II) The moment-generating function h v (θ) = E v (e θZ 1 ) satisfies h v (θ) < ∞ for some θ > 0. (III) The function g(x) is decreasing, its second order derivative function g ′′ (x) is continuous and bounded, and there is a positive number x * such that g(x * ) = 0. ) and and therefore, Θ ′ (θ(u)) = −H(θ(u)) = −H(θ * v ) = 0, Θ ′ (θ(1/x)) > 0 for x > 1/u and Θ ′ (θ(1/x)) < 0 for x > 1/u.
Hence, there exists a positive number b defined in (??). It can be seen, the main part of ARL v (T c (g)) will be an exponential function, square function, and linear function of c when the process {Z k : k ≥ 0} has no change or a "small change", a "medium change" and a "large change" from P v 0 to P v , respectively.
Here, the "small change" (v ∈ V − ) means that P v is closer to P v 0 than to P v 1 , i.e., I(P v |P v 0 ) < I(P v |P v 1 ), and the "large change" is just the opposite. The "medium change" (v ∈ V 0 ) corresponds to In this paper, we will use another method to prove Theorem 3 since Wald's identity and the martingale method do not hold or can not work for showing the ARLs estimation of the test T c (g) when g is not constant.
Next we compare the detection performance of the CUSUM-OAL test (ARL v (T c ′ (g))) with that of the CUSUM test (ARL v (T C (c))) by using (??) in Theorem 4.1. ) when µ 0 < µ < 0 and for θ * v 0 > g(µ)/g(µ 0 ) when µ ≥ 0. This means that ARL v (T c (g)) can be smaller than ARL v (T C (c)) as long as g(µ)/g(µ 0 ) is small for all µ > µ 0 .

NUMERICAL SIMULATION AND A REAL EX-AMPLE ILLUSTRATION

4.1 Numerical Simulation of ARLs for τ ≥ 1 By the simulation results of ARLs in Table , we see that the detection performance of T * (r), T C (c)∧T * (0), T * (0) and T C (c g u ) for large u is much better than that of the conventional CUSUM test T C for τ = 1. The following Table illustrates the simulation values of E τ i ,v and J ACE of nine tests in detecting two mean shifts v = 0.1 and v = 1 after six change-points, τ i , 1 ≤ i ≤ 6 with ARL 0 (T ) = E 0 (T ) ≈ 500.
Note that H v (θ) is a convex function and H ′ v (0) = µ < 0. This means that there is a unique positive number . It follows from (A.9) that for a large c. Taking θ ց θ * v and u ′ ց u, we have for a large c. Thus, by (A.11) we have as c → ∞. By the properties of exponential distribution, we have for a large c.
To prove the downward inequality of (A.10), let where b is defined in (??) and without loss of generality, we assume that b > a. Obviously, Let k = xcg(µ). By Chebyshev's inequality, we have Since Hv (θ) and H v (θ) are two convex functions and Let m = tcg(µ)θ * v /bc for t > 0. By (A.13), (A.14), (A.15) and Theorem 5.1 in Esary, Proschan and Walkup (1967) we have
Finally, as c → +∞, where θ 0 > 0 satisfies h v (θ 0 ) = 1. Thus as c → ∞. This implies that for a large c. This completes the proof of (A.10). Let v ∈ V 0 . Let m 1 = (cg(0)) 2 /σ 2 . It follows that Note that for a large c, where A = |g ′ (0)|/a, and , where Φ(.) is the standard normal distribution. Let m 2 = (cg(0)) 2 /(8σ 2 ln c).
Note that as c → ∞, where the third inequality comes from Theorem 5.1 in Esary, Proschan and Walkup (1967). Thus, we have Let v ∈ V + and let The uniform integrability of {T c (g)/c} for c ≥ 1, follows from the well-known uniform integrability of {T 0 /c} (see Gut (1988)).
Paper Info

Title: Efficient nonparametric estimation of Toeplitz covariance matrices
Publish Date: March 20, 2023
Author List: Karolina Klockmann (from Department of Statistics and Operations Research, Universität Wien), Tatyana Krivobokova (from Department of Statistics and Operations Research, Universität Wien)

Figure

Figure 1: Spectral density functions (first row) and autocovariance functions (second row) for examples 1, 2, 3.
Figure 2: Distance between the first atom and the first center of mass of aquaporin (left) and the opening diameter y t over time t (right).
black line in the left plot) confirms that the covariance matrix estimated with our VST-DCT method almost completely decorrelates the channel diameter Y on the training data set.Next, we estimated the regression coefficients β with the usual PLS algorithm, ignoring the dependence in the data.Finally, we estimated β with PLS that takes into account dependence using our covariance estimator Σ.Based on these regression coefficient estimators, the prediction on the test set was calculated.The plot on the right side of Figure 2 shows the Pearson correlation between the true channel diameter on the test set and the prediction on the same test set based on raw (grey) and decorrelated data (black).
Figure 3: On the left, the auto-correlation function of Y (grey) and of Σ−1/2 Y (black), where Σ is estimated with the VST-DCT method; On the right, correlation between the true values on the test data set and prediction based on partial least squares (in grey) and corrected partial least squares (black).
Uniform distributionThe observations follow a uniform distribution with covariance matrices Σ 1 , Σ 2 , Σ 3 of examples 1, 2, 3, i.e., Y i = Σ 1/2 j X i , j = 1, 3, with X 1 , ...the parameter innov of the R function arima.sim is used to pass the innovations X 1 , ..., X n i.i.d.Table4, 5 and 6 show respectively the results for (A) p = 5000, n = 1, (B) p = 1000, n = 50 and (C) p = 5000, n = 10.
(A) p = 5000, n = 1: Errors of the Toeplitz covariance matrix and the spectral density estimators with respect to the spectral and L 2 norm, respectively, as well as the average computation time of the covariance estimators in seconds for one Monte Carlo sample (last column).
(C) p = 5000, n = 10: Errors of the Toeplitz covariance matrix and the spectral density estimators with respect to the spectral and L 2 norm, respectively, as well as the average computation time of the covariance estimators in seconds for one Monte Carlo sample (last column).
(A) p = 5000, n = 1: Errors of the Toeplitz covariance matrix and the spectral density estimators with respect to the spectral norm and the L 2 norm, respectively.Average computation time of the covariance estimators in seconds for one Monte Carlo sample (last column).
(B) p = 1000, n = 50: Errors of the Toeplitz covariance matrix and the spectral density estimators with respect to the spectral norm and the L 2 norm, respectively.Average computation time of the covariance estimators in seconds for one Monte Carlo sample (last column).
(C) p = 5000, n = 10: Errors of the Toeplitz covariance matrix and the spectral density estimators with respect to the spectral norm and the L 2 norm, respectively.Average computation time of the covariance estimators in seconds for one Monte Carlo sample (last column).

abstract

A new nonparametric estimator for Toeplitz covariance matrices is proposed. This estimator is based on a data transformation that translates the problem of Toeplitz covariance matrix estimation to the problem of mean estimation in an approximate Gaussian regression. The resulting Toeplitz covariance matrix estimator is positive definite by construction, fully data-driven and computationally very fast.
Moreover, this estimator is shown to be minimax optimal under the spectral norm for a large class of Toeplitz matrices. These results are readily extended to estimation of inverses of Toeplitz covariance matrices. Also, an alternative version of the Whittle likelihood for the spectral density based on the Discrete Cosine Transform (DCT) is proposed.
The method is implemented in the R package vstdct that accompanies the paper.

Introduction

Estimation of covariance and precision matrices is a fundamental problem in statistical data analysis with countless applications in the natural and social sciences. Covariance matrices with a Toeplitz structure arise in the study of stationary stochastic n = 1, to the best of our knowledge, there is no fully data-driven approach for selecting the banding/tapering/thresholding parameter.
suggested first to split the time series into non-overlapping subseries and then apply the cross-validation criterion of . However, it turns out that the right choice of the subseries length is crucial for this approach, but there is no data-based method available for this. In this work, an alternative way to estimate a Toeplitz covariance matrix and its inverse is chosen.
Our approach exploits the one-to-one correspondence between Toeplitz covariance matrices and their spectral densities. First, the given data are transformed into approximate Gaussian random variables whose mean equals to the logarithm of the spectral density. Then, the log-spectral density is estimated by a periodic smoothing spline with a data-driven smoothing parameter.
Finally, the resulting spectral density estimator is transformed into an estimator for Σ or its inverse. It is shown that this procedure leads to an estimator that is fully data-driven, automatically positive definite and achieves the minimax optimal convergence rate under the spectral norm over a large class of Toeplitz covariance matrices.
In particular, this class includes Toeplitz covariance matrices that correspond to long-memory processes with bounded spectral densities. Moreover, the computation is very efficient, does not require iterative or resampling schemes and allows to apply any inference and adaptive estimation procedures developed in the context of nonparametric Gaussian regression.
Estimation of the spectral density from a stationary time series is a research topic with a long history. Earlier nonparametric methods are based on smoothing of the (log-)periodogram, which itself is not a consistent estimator . Another line of nonparametric methods for estimating the spectral density is based on the Whittle likelihood, which is an ap-proximation to the exact likelihood of the time series in the frequency domain.
For example, estimated the spectral density from a penalized Whittle likelihood, while used polynomial splines to estimate the log-spectral density function maximizing the Whittle likelihood. Recently, Bayesian methods for spectral density estimation have been proposed (see , but these may become very computationally intensive in large samples due to posterior sampling.
The minimax optimal convergence rate for nonparametric estimators of Hölder continuous spectral densities from Gaussian stationary time series was obtained by under the L p , 1 ≤ p ≤ ∞, norm. Only few works on spectral density estimation show the optimality of the corresponding estimators. In particular, and derived convergence rates of their estimators for the log-spectral density under the L 2 norm, while neglecting the Whittle likelihood approximation error.
In general, most works on spectral density estimation do not exploit further the close connection to the corresponding Toeplitz covariance matrix estimation. In particular, an upper bound for the L ∞ risk of a spectral density estimator automatically provides an upper bound for the risk of the corresponding Toeplitz covariance matrix estimator under the spectral norm.
This fact is used to establish the minimax optimality of our nonparametric estimator for the Toeplitz covariance matrices. The main contribution of this work is to show that our proposed spectral density estimator is not only numerically very efficient, but also achieves the minimax optimal rate in the L ∞ norm, which in turn ensures the minimax optimality of the corresponding Toeplitz covariance matrix estimator.
The paper is structured as follows. In Section 2, the model is introduced and ap-proximate diagonalization of Toeplitz covariance matrices with the discrete cosine transform is discussed. Moreover, an alternative version of the Whittle's likelihood is proposed. In Section 3, new estimators for the Toeplitz covariance matrix and the precision matrix are derived, while in Section 4 their theoretical properties are presented.
Section 5 contains simulation results, Section 6 presents a real data example, and Section 7 closes the paper with a discussion. The proofs are given in the appendix to the paper.

Set up and diagonalization of Toeplitz matrices

Let Y 1 , . . . , Y n i.i.d. ∼ N p (0 p , Σ), where Σ is a (p × p)-dimensional positive definite covariance matrix with a Toeplitz structure, that is, Σ = {σ |i−j| } p i,j=1 0. The sample size n may tend to infinity or to be a constant. The case n = 1 corresponds to a single observation of a stationary time series, and in this case the data are simply denoted by Y ∼N p (0 p , Σ).
The dimension p is assumed to grow. The spectral density function f , corresponding to a Toeplitz covariance matrix Σ, is given by so that for f ∈ L 2 (−π, π) the inverse Fourier transform implies Hence, Σ is completely characterized by f , and the non-negativity of the spectral density function implies the positive definiteness of the covariance matrix.
Moreover, the decay of the autocovariance σ k is directly connected to the smoothness of f . Finally, the convergence rate of a Toeplitz covariance estimator and that of the corresponding spectral density estimator are directly related via Σ ≤ f ∞ := sup x∈ |f (x)|, where • denotes the spectral norm (see .
As in , we introduce a class of positive definite Toeplitz covariance matrices with Hölder continuous spectral densities. For β = γ + α > 0, where The optimal convergence rate for estimating Toeplitz covariance matrices over P β (M 0 , M 1 ) depends crucially on β. It is well known that the k-th Fourier coefficient of a function whose γ-th derivative is α-Hölder continuous decays at least with order O(k −β ) (see .
Hence, β determines the decay rate of the autocovariances σ k , which are the Fourier coefficients of the spectral density f , as k → ∞. In particular, this implies that for β ∈ (0, 1], the class P β (M 0 , M 1 ) includes Toeplitz covariance matrices corresponding to long-memory processes with bounded spectral densities, since the sequence of corresponding autocovariances is not summable.
A connection between Toeplitz covariance matrices and their spectral densities is further exploited in the following lemma. Lemma 1. Let Σ ∈ P β (M 0 , M 1 ) and let x j = (j − 1)/(p − 1), j = 1, ..., p, then where δ i,j is the Kroneker delta, O(•) terms are uniform over i, j = 1, . . . , p and divided by √ 2 when i, j ∈ {1, p} is the Discrete Cosine Transform I (DCT-I) matrix.
The proof can be found in Appendix A.1. This result shows that the DCT-I matrix approximately diagonalizes Toeplitz covariance matrices and that the diagonalization error depends to some extent on the smoothness of the corresponding spectral density. In the spectral density literature the discrete Fourier transform (DFT) matrix
, where i is the imaginary unit, is typically employed to approximately diagonalize Toeplitz covariance matrices. Using the fact that introduced an approximation for the likelihood of a single Gaussian stationary time series (case n = 1), the so-called Whittle likelihood (1) The quantity , where F j denotes the j-th column of F , is known as the periodogram at the j-th Fourier frequency.
Note that due to periodogram symmetry, only p/2 data points I 1 , ..., I p/2 are available for estimating the mean f (2πj/p), j = 1, . . . , p/2 , where x denotes the largest integer strictly smaller than x. The Whittle likelihood has become a popular tool for parameter estimation of stationary time series, e.g., for nonparametric and parametric spectral density estimation or for estimation of the Hurst exponent, see e.g., ; .
Lemma 1 yields the following alternative version of the Whittle likelihood where W j = (D t j Y ) 2 . Note that this likelihood approximation is based on twice as many data points W j as the standard Whittle likelihood. Thus, it allows for a more efficient use of the data Y to estimate the parameter of interest, such as the spectral density or the Hurst parameter.
Equations ( ) or (2) invite for the estimation of f by maximizing the (penalized) likelihood over certain linear spaces (e.g., spline spaces), as suggested e.g., in or . However, such an approach requires well-designed numerical methods to solve the corresponding optimization problem, since the spectral density in the second term of (1) or ( ) is in the denominator, which does not allow to obtain a closed-form expression for the estimator and often leads to numerical instabilities.
Also, the choice of the smoothing parameter becomes challenging. Therefore, we suggest an alternative approach that allows the spectral density to be estimated as a mean in an approximate Gaussian regression. Such estimators have a closed-form expression, do not require an iterative optimization algorithm and a smoothing parameter can be easily obtained with any conventional criterion.
First Hence, for W j = (D t j Y ) 2 , j = 1, . . . , p it follows with Lemma 1 that where Γ(a, b) denotes a gamma distribution with a shape parameter a and a scale parameter b. Note that the random variables W 1 , . . . , W p are only asymptotically independent. Obviously, E(W j ) = f (πx j ) + O(1), j = 1, . . .
, p. To estimate f from W 1 , . . . , W p , one could use a generalized nonparametric regression framework with a gamma distributed response, see e.g., the classical monograph by . However, this approach requires an iterative procedure for estimation, e.g., a Newton-Raphson algorithm, with a suitable choice for the smoothing parameter at each iteration step.
Deriving the L ∞ rate for the resulting estimator is also not a trivial task. Instead, we suggest to employ a variance stabilizing transform of that converts the gamma regression into an approximate Gaussian regression. In the next section we present the methodology in more detail for a general setting with n ≥ 1.

Methodology

For Y i ∼ N p (0 p , Σ), i = 1, . . . , n, it was shown in the previous section that with Lemma 1 the data can be transformed into gamma distributed random variables . . , n, j = 1, . . . , p, where for each fixed i the random variable W i,j has the same distribution as W j given in (3). Now the approach of Cai et al. ( ) is adapted to the setting n ≥ 1.
First, the transformed data points W i,j are binned, that is, fewer new variables . . , T . Note that the number of observations in a bin is m = np/T . In Theorem 1 in Section 4, we show that setting T = p υ for any υ ∈ ((4 − 2 min{β, 1})/3, 1) leads to the minimax optimal rate for the spectral density estimator.
To simplify the notation, m is handled as an integer (otherwise, one can discard several observations in the last bin). Next, applying the variance stabilizing transform (VST) ∼ where H(y) = {φ(m/2) + log (2y/m)} / √ 2 and φ is the digamma function (see . Now, the scaled and shifted log-spectral density H(f ) can be estimated with a periodic smoothing spline
where h > 0 denotes a smoothing parameter, q ∈ N is the penalty order and S per (2q − 1) a space of periodic splines of degree 2q − 1. The smoothing parameter h can be chosen either with generalized cross-validation (GCV) as derived in or with the restricted maximum likelihood, see . Once an estimator H(f ) is obtained, application of the inverse transform function H −1 (y) = m exp √ 2y − φ (m/2) /2 yields the spectral density estimator f = H −1 H(f ) .
Finally, using the inverse Fourier transform leads to the fol- The precision matrix Ω is estimated by the inverse Fourier transform of the reciprocal of the spectral density estimator, i.e., Ω = (ω |i−j| ) p i,j=1 with ωk = The estimation procedure for Σ and Ω can be summarised as follows. 1. Data Transformation:
where D is the (p × p)-dimensional DCT-I matrix as given in Lemma 1 and D j is its j-th column. 2. Binning: Set T = p υ for any υ ∈ ((4 − 2 min{β, 1})/3, 1) and calculate W i,j , k = 1, . . . , T.

VST:

where k are asymptotically i.i.d. Gaussian variables. Inverse VST: Estimate the spectral density f with f = H −1 H(f ) , where Note that Σ and Ω are positive definite matrices by construction, since their spectral density functions f and f −1 are non-negative, respectively. Unlike the banding and tapering estimators, the autocovariance estimators σk are controlled by a single smoothing parameter h, which can be estimated fully data-driven with several available automatic methods, which are numerically efficient and well-studied.
In addition, one can also use methods for adaptive mean estimation, see e.g., , which in turn leads to adaptive Toeplitz covariance matrix estimation. All inferential procedures developed in the Gaussian regression context can also be adopted accordingly.

Theoretical Properties

In this section, we study the asymptotic properties of the estimators f , Σ and Ω. The results are established under the asymptotic scenario where p → ∞ and p/n → c ∈ (0, ∞], that is, the dimension p grows, while the sample size n either remains fixed or also grows but not faster than p. This corresponds to the asymptotic scenario when the sample covariance matrix is inconsistent.
Let f be the spectral density estimator defined in Section 3, i.e., f = m exp{ √ 2 H(f ) − φ(m/2)}/2, where H(f ) is given in (4), m = np/T and φ is the digamma function. Furthermore, let Σ be the Toeplitz covariance matrix estimator and Ω the corresponding precision matrix defined in equations ( ) and (6), respectively.
The following theorem shows that both Σ and Ω attain the minimax optimal rate of convergence over the class and hT → ∞, then with T = p υ for any υ ∈ ((4 − 2 min{β, 1})/3, 1) and q = max{1, γ}, the spectral density estimator f , the corresponding covariance matrix estimator Σ and the precision matrix estimator Ω satisfy sup
For h {log(np)/(np)} . The proof of Theorem 1 can be found in the Appendix A.3 and is the main result of our work. The most important part of this proof is the derivation of the convergence rate for the spectral density estimator f under the L ∞ norm. In the original work, established an L 2 rate for a wavelet nonparametric mean estimator in a gamma regression where the data are assumed to be independent.
In our work, the spectral density estimator f is based on the gamma distributed data W i,1 , . . . , W i,p , which are only asymptotically independent. Moreover, the mean of these data is not exactly f (πx 1 ), . . . , f (πx p ), but is corrupted by the diagonalization error given in Lemma 1. This error adds to the error that arises via binning and VST and that describes the deviation from a Gaussian distribution, as derived in .
Finally, we need to obtain an L ∞ rather than an L 2 rate for our spectral density estimator. Overall, the proof requires different tools than those used in . To get the L ∞ rate for f , we first derive that for the periodic smoothing spline estimator H(f ) of the log-spectral density. To do so, we use a closed-form expression of its effective kernel obtained in , thereby carefully treating various (dependent) errors that describe deviations from a Gaussian nonparametric regression with independent errors and mean f (πx i ).
Note also that although the periodic smoothing spline estimator is obtained on T binned points, the rate is given in terms of the vector dimension p. Then, using the Cauchy-Schwarz inequality and a mean value argument, this rate is translated into the L ∞ rate for the spectral density estimator f . To obtain the rate for the Toeplitz covariance matrix estimator is enough to note that

Simulation Study

In this section, we compare the performance of the proposed Toeplitz covariance estimator, denoted as VST-DCT, with the tapering estimator of and with the sample covariance matrix. We consider Gaussian vectors Y 1 , ..., (3) such that the corresponding spectral density is Lipschitz continuous but not differentiable: f (x) = 1.44{| sin(x + 0.5π)| 1.7 + 0.45}.
In particular, var(Y i ) = 1.44 in all three examples. Figure shows the spectral densities and the corresponding autocorrelation functions for the three examples. A Monte Carlo simulation with 100 iterations is performed using R (version 4.1.2, seed 42). For our VST-DCT estimator, we use a cubic periodic spline, i.e., q = 2 is set in (4).
The binning parameters are set to T = 500 bins with m = 10 points for (A) and T = 500 bins with m = 100 points for both (B) and (C). To select the regularisation parameter for our estimator, we implemented the restricted maximum likelihood (ML) method, generalized cross validation (GCV) and the corresponding oracle versions, i.e., as if Σ were known.The tapering parameter
where T ap k (Σ ν 2 ) is the tapering estimator of with parameter k. If n = 1, that is, under scenario (A), suggest to split the time series Y into l non-overlapping subseries of length p/l and then proceed as before to select the tuning parameter k. To the best of our knowledge, there is no data-driven method for selecting this parameter l.
Using the true covariance matrix Σ, we selected l = 30 subseries for the example 1 and l = 15 subseries for the exam-ples 2 and 3. The parameter k can then be chosen by cross-validation as above. We employ this approach under scenario (A) instead of an unavailable fully data-driven criterion and name it semi-oracle.
Finally, for all three scenarios (A), (B) and (C), the oracle tapering parameter is computed using grid search for each Monte Carlo sample as kor = arg min k=2,3,...,p/2 T ap k ( Σ) − Σ , where Σ is the sample covariance matrix. To speed up the computation, one can replace the spectral norm by the 1 norm, as suggested by .
In Tables , the errors of the Toeplitz covariance estimators with respect to the spectral norm and the computation time for one Monte Carlo iteration are given for scenarios (A), (B) and (C), respectively. To illustrate the goodness-of-fit of the spectral density, the L 2 norm f − f 2 is also computed.
The results show that the tapering and VST-DCT estimator perform overall similar in terms of the spectral norm risk. This is not surprising as both estimators are proved to be rate-optimal. Moreover, both the tapering and VST-DCT estimators are clearly superior to the inconsistent sample Toeplitz covariance matrix.
A closer look at the numbers shows that the VST-DCT method has better constants, i.e., VST-DCT estimators have somewhat smaller errors in the spectral norm than the tapering estimators across all examples, but especially under scenario (C). The oracle estimators show similar behaviour, but are slightly less variable compared to the data-driven estimators.
In general, both the tapering and VST-DCT estimators perform best for example 1, second best for example 3 and worst for example 2, which traces back to functions complexity. In terms of computational time, both methods are similarly fast for scenarios (A) and (B). For scenario (C), the tapering method is much slower due to the multiple high-dimensional matrix multiplications in the cross-validation method.
It is expected that for larger p the tapering estimator is much more computationally intensive than the corresponding VST-DCT estimator. (1) polynomial σ ( (  To test how robust our approach is to deviations from the Gaussian assumption, we simulated the data from gamma and uniform distributions and conducted a simulation study for the same scenarios and examples.
The results are very similar to those of the Gaussian distribution, see supplementary materials for the details.

Application to Protein Dynamics

We revisit the data analysis of protein dynamics performed in Krivobokova et al. (2012) and . We consider data generated by the molecular dynamics (MD) simulations for the yeast aquaporin (Aqy1) -the gated water channel of the yeast Pichi pastoris. MD simulations are an established tool for studying biological systems at the atomic level on timescales of nano-to microseconds.
The data are given as Euclidean coordinates of all 783 atoms of Aqy1 observed in a 100 nanosecond time frame, split into 20 000 equidistant observations. Additionally, the diameter of the channel y t at time t is given, measured by the distance between two centers of mass of certain residues of the protein.
The aim of the analysis is to identify the collective motions of the atoms responsible for the channel opening. In order to model the response variable y t , which is a distance, based on the motions of the protein atoms, we chose to represent the protein structure by distances between atoms and certain fixed base points instead of Euclidean coordinates.
That is, we calculated where A t,i ∈ R 3 , i = 1, . . . , 783 denotes the i-th atom of the protein at time t, B j ∈ R 3 , j = 1, 2, 3, 4, is the j-th base point and d(•, •) is the Euclidean distance. Figure shows the diameter y t and the distance between the first atom and the first center of mass. It can therefore be concluded that a linear model Y = Xβ + holds, where
. This linear model has two specific features which are intrinsic to the problem: first, the observations are not independent over time and second, X t is high-dimensional at each t and only few columns of X are relevant for Y . have shown that the partial least squares (PLS) algorithm performs exceptionally well on this type of data, leading to a small-dimensional and robust representation of proteins, which is able to identify the atomic dynamics relevant for Y .
Singer et al. ( ) studied the convergence rates of the PLS algorithm for dependent observations and showed that decorrelating the data before running the PLS algorithm improves its performance. Since Y is a linear combination of columns of X, it can be assumed that Y and all columns of X have the same correlation structure.
Hence, it is sufficient to estimate Σ = cov(Y ) to decorrelate the data for the PLS algorithm, i.e., Σ −1/2 Y = Σ −1/2 Xβ + Σ −1/2 results in a standard linear regression with independent errors. Our goal now is to estimate Σ and compare the performance of the PLS algorithm on original and decorrelated data.
For this purpose, we divided the data set into a training and a test set (each with p = 10 000 observations). First, we tested whether the data are stationary. The augmented Dickey-Fuller test confirmed stationarity for Y with a p-value< 0.01. The Hurst exponent of Y is 0.85, indicating moderate long-range dependence supported by a rather slow decay of the sample autocovariances (see grey line in the left plot of Figure ).
Therefore, we set q = 1 for the VST-DCT estimator to match the low smoothness of the corresponding spectral density. Moreover, the smoothing parameter is selected with the restricted maximum likelihood method and T = 550 bins are used. Obviously, the performance of the PLS algorithm on the decorrelated data is significantly better for the small number of components.
In particular, with just one PLS component, the correlation between the true opening diameter on the test set and its prediction that takes into account the dependence in the data is already 0.54, while it is close to zero for PLS that ignores the dependence in the data. showed that the estimator of β based on one PLS component is exactly the ensemble-weighted maximally correlated mode (ewMCM), which is defined as the collective mode of atoms that has the highest probability to achieve a specific alteration of the response Y .
Therefore, an accurate estimator of this quantity is crucial for the interpretation of the results and can only be achieved if the dependence in the data is taken into account. Estimating Σ with a tapered covariance estimator has two practical problems. First, since we only have a single realization of a time series Y (n = 1), there is no datadriven method for selecting the tapering parameter.
Second, the tapering estimator turned out not to be positive definite for the data at hand. To solve the second problem, we truncated the corresponding spectral density estimator ftap to a small positive value, i.e., f + tap = max{ ftap , 1/ log(p)} (see . To select the tapering parameter with cross-validation, we experimented with different subseries lengths and found that the tapering estimator is very sensitive to this choice.
For example, estimating the tapered covariance matrix based on subseries of length 8/15/30 yields a correlation of 0.42/0.53/0.34 between the true diameter and the first PLS component, respectively. Altogether, our proposed estimator is fully data-driven, fast even for large sample sizes, automatically positive definite and can handle certain long-memory processes.
In contrast, the tapering estimator is not data-driven and must be manipulated to become positive definite. Our method is implemented in the R package vstdct.

Discussion

In this paper, we proposed a simple, fast, fully data-driven, automatically positive definite and minimax optimal estimator of Toeplitz covariance matrices from a large class that also includes covariance matrices of certain long-memory processes. Our estimator is derived under the assumption that the data are Gaussian.
However, simulations show that the suggested approach yields robust estimators even when the data are not normally distributed. In the context of spectral density estima- , for mixing processes (see Theorem 5.3 of Rosenblatt, 2012), as well as for non-linear processes (see . Since DFT and DCT matrices are closely related, we expect that equation (3) also holds asymptotically for these non-Gaussian time series, but consider a rigorous analysis to be beyond the scope of this paper.
In fact, our numerical experiments have even shown that if the spectral density is estimated from W j = f (πx j ) + j , that is, as if W j were Gaussian instead of gamma distributed, then the resulting spectral density estimator has almost the same L ∞ risk (and hence the corresponding covariance matrix has almost the same spectral norm).
Of course, such an estimator would lead to a wrong inference about f (πx j ), since the growing variance of W j would be ignored. Since our approach translates Toeplitz covariance matrix estimation into a mean estimation in an approximate Gaussian nonparametric regression, all approaches developed in the context of Gaussian nonparametric regression, such as (locally)
adaptive estimation, as well as the corresponding (simultaneous) inference, can be directly applied. Bayesian tools for adaptive estimation and inference in Gaussian nonparametric regression as proposed in can also be employed.

Appendix

Throughout the appendix, we denote by c, c 1 , C, C 1 , . . . etc. generic constants, that are independent of n and p. To simplify the notation, the constants are sometimes skipped and we write for less than or equal to up to constants. We embed the p-dimensional Toeplitz matrix Σ = toep(σ 0 , . . . , σ p−1 ) in a (2p − 2)dimensional circulant matrix Σ = toep(σ 0 , . . .
, σ p−1 , σ p−2 , . . . , σ 1 ). Then, Σ = with the conjugate transpose U * , and Λ is a diagonal matrix with the k-th diagonal value for k = 1, ..., p given by Furthermore, Σ = V * ΛV , where V ∈ C (2p−2)×p contains the first p columns of U . In particular, b(j, r) = b(j, 2p−r) and c(j, r) = −c(j, 2p−r) for r = p+1, . . .
, 2p−2. Together, we have (A.1) Some calculations show that for r = 1, . . . p Using the Taylor expansion of cot(x) for 0 < |x| < π one obtains for r = 1, . . . p where the O term does not depend on j and the hidden constant does not depend on r, p. If i = j, equations (A.1) -(A.3) imply where the O terms do not depend on j.
Since the complex exponential function is Lipschitz continuous with constant L = 1, it holds λ r = λ j + L r,j |r − j|p −1 where −1 ≤ L r,j ≤ 1 is a constant depending on r, j. Then, , it is sufficient to consider j = 1, ..., p − 1. We begin with first sum. For a shorter notation, we use k := r − 1 and l := j − 1 in the following.
Then, summing the squares of the first term in (A.4) for l = 0, ..., p−2 on sums of reciprocal powers. If p is even, then the residual terms are given by where φ and φ (1) denote the digamma function and its derivative. If p is odd, similar remainder terms can be derived. To see that R i (l, p) = O(p −1 ) for i = 1, 2, 3 and uniformly in l we use that asymptotically φ(x)∼ log(x)−1/(2x) and
The mixed term are both of the order p −1 . Furthermore, since the harmonic sum diverges at a rate of log(p). Finally, λ j = f (x j )+O{log(p)p −β } by the uniform approximation properties of the discrete Fourier series for Hölder continuous functions (see . All together, we have shown that (DΣD) j,j = where the O terms are uniform over j = 1, ..., p.
Case i = j and |i − j| is even In this case, (DΣD) i,j = a i a j uniformly in i, j. To show that a i a j 2p−2 r=1 λ r c(i, r)c(j, r) = O(p −1 ), we proceed similarly as before. Setting k=r−1, l=j−1, m=i−1 and using that l =m and |l−m| is even, one obtains where for even p the residual terms are given by If p is odd, analogous residual terms can be derived.
Using similar techniques as before, one can show that the two residual terms and the remaining mixed and square terms vanish at a rate of the order O(p −1 ) and uniformly in i, j. Case i = j and |i − j| is odd |r − i| and |r − j| are either odd and even, or even and odd. Without loss of generality, assume that |r − i| is even.
Then, (DΣD) i,j = a i a j 2p−2 r=1 λ r b(i, r)c(j, r). Since b(i, •) is an even function, c(j, •) is an odd function and λ r = λ 2p−r , it follows (DΣD) i,j = 0. The structure of the proof is as follows. First, we derive the L ∞ rate of the periodic smoothing spline estimator H(f ). Then, using the Cauchy-Schwarz inequality and a mean value argument, the convergence rate of the spectral density estimator f is
∞ the first claim of the theorem follows. Finally, we prove the second statement on the precision matrices. For the sake of clarity, some technical lemmas used in the proof are listed separately in A.4. hT → ∞, then with T = p υ for any υ ∈ ((4 − 2 min{1, β})/3, 1), the estimator H(f ) described in Section 3 with q = max{1, γ} satisfies
Proof : Application of the triangle inequality yields a bias-variance decomposition Set T = 2T − 2 and x k = (k − 1)/ T for k = 1, ..., T . Using Lemma 4, we can write where Mirroring and renumerating ζ k , η k , k is similar as for Y * k , k = 1, ..., T . Using the above representation, one can write First we reduce the supremum to a maximum over a finite number of points.
If q > 1, then W (•, x k ) is Lipschitz continuous with constant L > 0. In this case, it holds almost surely that sup ) is a piecewise linear function with knots at x j = j/ T . The factor (ζ k + ξ k ) can be considered as stochastic weights that do not affect the piecewise linear property. Thus, the supremum is attained at one of the knots x j = j/ T , j = 1, ..., T , and (A.7) is also valid for q = 1.
Again with (a + b) 2 ≤ 2a 2 + 2b 2 we obtain We start with bounding . This requires a bound on 1 • ψ 2 denotes the sub-Gaussian norm. In case of a Gaussian random variable the norm equals to the variance. Thus with Lemma 2 and Lemma 4, we obtain Lemma 1.6 of ) then yields Recall that T = p υ for some fixed υ ∈ ((4 − 2 min{1, β})/3, 1).
Using the inequality log(x) ≤ x a /a one can find constants x υ , C υ > 0 depending on υ but not on n, p such that log(2 T ) log(p) Next, we derive a bound for the second term The exponential decay property of the kernel K stated in Lemma 2 yields The first term in (A.9) can be bounded again with Lemma 1.6 of .
We use the fact that for not necessarily independent random variables X 1 , ..., X N R and R > 0 are constants. This is a consequence of Lemma 1 of which yields , it follows that N i=1 a i X i has a subGaussain distribution and the subGaussian norm is bounded by 2R( N i=1 a 2 i ) 1/2 . See for further details on the subgaussian distribution.
T h . For the second inequality Lemma 2(ii) is used. Applying Lemma 1.6 of then yields To bound the second term in (A.9), we use the moment bounds for ξ k derived in Lemma 4. Then, for all integers > 1 Combining the error bounds (A.10) and (A.11) and choosing R=m −1/2 gives By assumption T = p υ and m = np (1−υ) for some fixed υ ∈ ((4 − 2 min{1, β})/3, 1).
If is an integer such that ≥ 1/(1 − υ), then where we used log(x) ≤ x a /a with a = 1/(4 ). Consider 1/2 < β ≤ 1 and let 0 < χ < 1 be a constant. Applying log(x) ≤ x a /a twice with a = χ/(2 ) yields For any fixed υ∈((4 − 2 min{1, β})/3, 1) one can find an integer which is independent of n, p such that the right side of (A.12) holds.
Since p/n → c ∈ (0, ∞] and thus n/p = O(1) and p −1 = O(n −1 ), it follows for satisfying (A.12) that In total, choosing an integer Using the representation in Lemma 4 once more gives for each x ∈ [0, 1] The bounds on k in Lemma 4 imply Consider the case that β ≥ 1. In particular, q = γ and f (q) is α-Hölder continuous.
Since f is a periodic function with f (x) ∈ [δ, M 0 ] and H(y) ∝ φ(m/2)+ log (2y/m), it follows that {H(f )} (q) is also α-Hölder continuous. Extending g := H(f ) to the entire real line, we get Expanding g(t) in a Taylor series around x and using that h −1 K h is a kernel of order 2q, see Lemma 2(iii), it follows that for any x ∈ [0, 1]
where ξ x,t is a point between x and t. Using the fact that the kernel K h decays exponentially and that g (q) is α-Hölder continuous on [δ, M 0 ] with some constant L, the logarithm is Lipschitz continuous on a compact interval, it follows g = H(f ) is β-Hölder continuous. Expanding g to the entire line and using Lemma 2(iii) with
In a similar way as before, one obtains Note that T −β =o(h β ) as β > 1/2, T h → ∞ and h → 0 by assumption. Since the derived bounds are uniform for x ∈ [0, 1] it holds Putting the bounds A.13 and A.14 together gives If h > 0 such that h → 0 and hT → ∞, then with T = p υ for any υ ∈ ((4 − 2 min{1, β})/3, 1), the estimator f described in Section 3 with q = max{1, γ} satisfies
Proof : By the mean value theorem, it holds for some function g between H(f ) and To show that the second term on the right hand side of (A.15) is negligible we use the moment generating function of H(f ) ∞ . In the next paragraph, we derive the asymptotic order of E[exp{λ H(f ) ∞ }] for n, p → ∞, where λ > 0 may depend on n, p or not.
By the exponential decay property of the kernel K stated in Lemma 2 holds First, H(f ) ∞ is bounded with the maximum over a finite number of points. Calculating the derivative of s : Since δ δx s(x) > 0 almost surely for x = x k , the extrema occur at x k , k = 1, ..., T . Thus, for λ > 0 the moment generating function of H(f ) ∞ is bounded by
Let M j = ( T h) −1 T k=1 γ h (x j , x k ), which by Lemma 2 is bounded uniformly in j by some global constant M > 0. By the convexity of the exponential function we obtain √ 2 and by assumption 0 ≤ δ ≤ f ≤ M 0 . Using Lemma 3, Q k can be written as a sum of m = np/T independent gamma random variables, i.e.
The moment generating function of | log(X)| when X follows a Γ(a, b)-distribution is given by where Γ(a) is the gamma function and γ(a, b) is the lower incomplete gamma function. In particular, To derive the asymptotic order of E[exp{λ H(f ) ∞ }] for n, p → ∞ we first establish the asymptotic order of the ratio Γ(a + t)/Γ(a) for a → ∞.
We distinguish the two cases where t is independent of a and where t linearly depends on a. Thus, for 0 < t < a and t independent of a, equation (A.17) implies for a → ∞ that Γ(a + t)/Γ(a) = O(a t ). Similarly, it can be seen that Γ(a − t)/Γ(a) = O(a −t ). If 0 < t < a and t linearly depends on a, i.e. t = ca for some constant c ∈ (0, 1), then we get Γ(a ± t)/Γ(a) = O(a ±t exp{a}) for a → ∞.
Hence, for a fixed λ not depending on n, p and such that 0 < λ < m/( √ 2M j ) we get for sufficiently large n, p If λ = cm such that 0 < λ < m/( √ 2M j ), then for sufficiently large n, p b∈{cδ/m,cM 0 /m} (bm/2) for some constant L > 1. Set K = min j=1,..., T 1/( √ 2M j ) which is a constant independent of n, p. Altogether, we showed that for 0 < λ < Km and n, p → ∞
Bounding the right hand side of (A.15) for some constants c 0 , c 1 > 0 and n, p → ∞ Since g lies between H(f ) and H(f ), and f almost surely pointwise. Thus, for C > f ∞ = M 0 it holds where c 1 := H(C − M 0 ). Applying Markov inequality for t = cm with c ∈ (0, K) and C = 2L 4/c + M 0 where c, K, L are the constants in gives
Together with Proposition 1 follows Using the fact that the spectral norm of a Toeplitz matrix is upper bounded by the sup norm of its spectral density we get sup According to the mean value theorem, for a function g between H(f ) and H(f ), it holds that some constant c 1 > 0 not depending on n, p. Chosing the same constant C as in section A.3.2 it follows
Noting that 1/f ∞ ≤ 1/δ and 2/m exp {φ(m/2)} ∈ [0.25, 1] for m ≥ 1, (A.18) implies for some constants c 2 , c 3 > 0 and n, p → ∞ Since the derived bounds hold for each Σ(f ) ∈ F β , we get all together sup This section states some technical lemmata needed for the proof of Theorem 1. The proofs can be found in the supplementary material.
The first lemma lists some properties of the kernel K h and its extension K h on the real line. The proof is based on . Lemma 2. Let h > 0 be the bandwith parameter depending on N . (i) There are constants 0 < C < ∞ and 0 < γ < 1 such that for all for x, t ∈ [0, 1] Lemma 3 states that the sum of the correlated gamma random variables in each bin can be rewritten as a sum of independent gamma random variables.
for i = 1, ..., n and j = (k − 1)m + 1, ..., km, and x j = (j − 1)/(2p − 2). Finally, Lemma 4 gives explicit bounds for the stochastic and deterministic errors of the variance stabilizing transform. Thus, it quantifies the difference to an exact Gaussian regression setting. This result is a generalization of Theorem 1 of Cai et al.
(2010) adapted to our setting with n ≥ 1 observations and correlated observations. √ 2 can be written as where for the proof of the first statement. Furthermore, for x, t ∈ [0, 1] holds In particular, for some constants C 1 , C 2 > 0 depending on γ ∈ (0, 1) but not on h and x, it holds h (iii) See Lemma 15 of with p = 2q − 1.
It is sufficient to show the statement for n = 1 by independence of the Y i . Then, the number of points per bin is m = p/T . For simplicity, the index i is skipped in the following. First, we write Q k as a matrix-vector product and refactor it so that it corresponds to a sum of independent scaled χ 2 random variables.
In the second step, we calculate the scaling factors. Let E (km) be a diagonal matrix with ones on the (k − 1)m + 1, ..., km-th entries and otherwise zero diagonal elements. Then, By Theorem 1 of for the gamma distribution it follows where Wi,j iid. ∼ Γ(1/2, 2 f (x * k )) and such that Cov( Wi,j , Wi,h ) = Cov(W i,j , W i,h ) for j = (k − 1)p/T + 1, ..., kp/T and h ∈ {1, ..., p} \ {(k − 1)p/T + 1, ..., kp/T }.
Let θ be the maximum difference of the observations' means in each bin. Then, θ = max are defined via quantile coupling, it holds Z k = Φ −1 {F Q( Qk )} (see . Furthermore, define the uniform random variables Let ρ = Cov(Z k , Z l ). Then, the identity implies F Z,Z (x, y) − Φ(x)Φ(y) ≥ 0 for all x, y ∈ R ⇐⇒ ρ ≥ 0, (see .
Since Cov( Qk , Ql ) ≥ 0 and the ratio of two densities is non-negative, x = − 2/m, it follows that f Q(x) is monotone decreasing for x ≥ − 2/m. Furthermore, F Q(− m/2) ≤ 0.5 for all m ∈ N as f Q(x) is right-skewed. In particular, − m/2 ≤ F −1 Q (1/2) for all m ∈ N. Finally, since f Q(− 2/m) → φ(0) for m → ∞ there is a constant c > 0 not depending on m such that
The simulation study in Section 5 is performed in the same way, but with the uniform and the gamma distribution instead of the Gaussian distribution.
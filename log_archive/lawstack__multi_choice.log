nohup: ignoring input
[nltk_data] Downloading package punkt to /home/kyosuke/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package punkt_tab to
[nltk_data]     /home/kyosuke/nltk_data...
[nltk_data]   Package punkt_tab is already up-to-date!
Some weights of the model checkpoint at vblagoje/dpr-question_encoder-single-lfqa-base were not used when initializing DPRQuestionEncoder: ['question_encoder.bert_model.pooler.dense.bias', 'question_encoder.bert_model.pooler.dense.weight']
- This IS expected if you are initializing DPRQuestionEncoder from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DPRQuestionEncoder from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
/home/kyosuke/auto-rag-eval/venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:1617: FutureWarning: `clean_up_tokenization_spaces` was not set. It will be set to `True` by default. This behavior will be deprecated in transformers v4.45, and will be then set to `False` by default. For more details check this issue: https://github.com/huggingface/transformers/issues/31884
  warnings.warn(
Some weights of the model checkpoint at vblagoje/dpr-question_encoder-single-lfqa-base were not used when initializing DPRQuestionEncoder: ['question_encoder.bert_model.pooler.dense.bias', 'question_encoder.bert_model.pooler.dense.weight']
- This IS expected if you are initializing DPRQuestionEncoder from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DPRQuestionEncoder from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of the model checkpoint at vblagoje/dpr-ctx_encoder-single-lfqa-base were not used when initializing DPRContextEncoder: ['ctx_encoder.bert_model.pooler.dense.bias', 'ctx_encoder.bert_model.pooler.dense.weight']
- This IS expected if you are initializing DPRContextEncoder from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing DPRContextEncoder from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Deleting existing Faiss index: /home/kyosuke/auto-rag-eval/auto-rag-eval/Data/LawStackExchange/RetrievalIndex/siamese_emb/kilt_dpr_data.faiss
Deleting existing Faiss index cache /home/kyosuke/auto-rag-eval/auto-rag-eval/Data/LawStackExchange/RetrievalIndex/siamese_emb/data_kilt_embedded.arrow
SiameseContextProvider
SiameseContextProvider
Creating faiss index:   0%|          | 0/9862 [00:00<?, ? examples/s]Creating faiss index:   5%|▌         | 512/9862 [00:46<14:01, 11.11 examples/s]Creating faiss index:   5%|▌         | 512/9862 [01:02<14:01, 11.11 examples/s]Creating faiss index:  10%|█         | 1024/9862 [01:31<13:06, 11.23 examples/s]Creating faiss index:  10%|█         | 1024/9862 [01:42<13:06, 11.23 examples/s]Creating faiss index:  16%|█▌        | 1536/9862 [02:17<12:22, 11.22 examples/s]Creating faiss index:  16%|█▌        | 1536/9862 [02:32<12:22, 11.22 examples/s]Creating faiss index:  21%|██        | 2048/9862 [03:01<11:31, 11.30 examples/s]Creating faiss index:  21%|██        | 2048/9862 [03:12<11:31, 11.30 examples/s]Creating faiss index:  26%|██▌       | 2560/9862 [03:47<10:46, 11.29 examples/s]Creating faiss index:  26%|██▌       | 2560/9862 [04:02<10:46, 11.29 examples/s]Creating faiss index:  31%|███       | 3072/9862 [04:39<10:33, 10.72 examples/s]Creating faiss index:  36%|███▋      | 3584/9862 [05:31<10:03, 10.40 examples/s]Creating faiss index:  42%|████▏     | 4096/9862 [06:33<09:58,  9.63 examples/s]Creating faiss index:  47%|████▋     | 4608/9862 [07:35<09:33,  9.15 examples/s]Creating faiss index:  52%|█████▏    | 5120/9862 [08:40<09:04,  8.71 examples/s]Creating faiss index:  57%|█████▋    | 5632/9862 [09:51<08:36,  8.18 examples/s]Creating faiss index:  62%|██████▏   | 6144/9862 [11:38<09:11,  6.74 examples/s]Creating faiss index:  67%|██████▋   | 6656/9862 [13:20<08:45,  6.10 examples/s]Creating faiss index:  73%|███████▎  | 7168/9862 [15:03<07:52,  5.71 examples/s]Creating faiss index:  78%|███████▊  | 7680/9862 [16:46<06:38,  5.47 examples/s]Creating faiss index:  83%|████████▎ | 8192/9862 [18:29<05:14,  5.32 examples/s]Creating faiss index:  88%|████████▊ | 8704/9862 [20:11<03:42,  5.21 examples/s]Creating faiss index:  93%|█████████▎| 9216/9862 [21:54<02:05,  5.14 examples/s]Creating faiss index:  99%|█████████▊| 9728/9862 [23:37<00:26,  5.08 examples/s]Creating faiss index: 100%|██████████| 9862/9862 [24:01<00:00,  5.15 examples/s]Creating faiss index: 100%|██████████| 9862/9862 [24:01<00:00,  6.84 examples/s]
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 314.30it/s]
Faiss index successfully created
Deleting existing Faiss index: /home/kyosuke/auto-rag-eval/auto-rag-eval/Data/LawStackExchange/RetrievalIndex/multi_qa_emb/kilt_dpr_data.faiss
Deleting existing Faiss index cache /home/kyosuke/auto-rag-eval/auto-rag-eval/Data/LawStackExchange/RetrievalIndex/multi_qa_emb/data_kilt_embedded.arrow
Creating faiss index:   0%|          | 0/9862 [00:00<?, ? examples/s]Creating faiss index:   5%|▌         | 512/9862 [00:54<16:36,  9.38 examples/s]Creating faiss index:  10%|█         | 1024/9862 [01:49<15:41,  9.39 examples/s]Creating faiss index:  16%|█▌        | 1536/9862 [02:44<14:52,  9.33 examples/s]Creating faiss index:  21%|██        | 2048/9862 [03:40<14:05,  9.24 examples/s]Creating faiss index:  26%|██▌       | 2560/9862 [04:35<13:09,  9.25 examples/s]Creating faiss index:  31%|███       | 3072/9862 [05:30<12:10,  9.30 examples/s]Creating faiss index:  36%|███▋      | 3584/9862 [06:27<11:22,  9.20 examples/s]Creating faiss index:  42%|████▏     | 4096/9862 [07:22<10:25,  9.22 examples/s]Creating faiss index:  47%|████▋     | 4608/9862 [08:17<09:28,  9.24 examples/s]Creating faiss index:  52%|█████▏    | 5120/9862 [09:12<08:30,  9.29 examples/s]Creating faiss index:  57%|█████▋    | 5632/9862 [10:07<07:35,  9.29 examples/s]Creating faiss index:  62%|██████▏   | 6144/9862 [11:02<06:40,  9.28 examples/s]Creating faiss index:  67%|██████▋   | 6656/9862 [11:58<05:46,  9.25 examples/s]Creating faiss index:  73%|███████▎  | 7168/9862 [12:52<04:49,  9.31 examples/s]Creating faiss index:  78%|███████▊  | 7680/9862 [13:48<03:55,  9.26 examples/s]Creating faiss index:  83%|████████▎ | 8192/9862 [14:42<02:59,  9.31 examples/s]Creating faiss index:  88%|████████▊ | 8704/9862 [15:36<02:03,  9.35 examples/s]Creating faiss index:  93%|█████████▎| 9216/9862 [16:32<01:09,  9.29 examples/s]Creating faiss index:  99%|█████████▊| 9728/9862 [17:27<00:14,  9.33 examples/s]Creating faiss index: 100%|██████████| 9862/9862 [17:42<00:00,  9.27 examples/s]Creating faiss index: 100%|██████████| 9862/9862 [17:42<00:00,  9.28 examples/s]
  0%|          | 0/10 [00:00<?, ?it/s]100%|██████████| 10/10 [00:00<00:00, 319.41it/s]
Faiss index successfully created
Starting to load all raw questions from /home/kyosuke/auto-rag-eval/auto-rag-eval/Data/LawStackExchange/RawExamData/
Initialising MultiChoiceExamLLM
